package uk.ac.ed.inf;import uk.ac.ed.inf.ilp.constant.OrderStatus;import uk.ac.ed.inf.ilp.constant.OrderValidationCode;import uk.ac.ed.inf.ilp.constant.SystemConstants;import uk.ac.ed.inf.ilp.data.Order;import uk.ac.ed.inf.ilp.data.Pizza;import uk.ac.ed.inf.ilp.data.Restaurant;import uk.ac.ed.inf.ilp.interfaces.OrderValidation;import java.time.LocalDate;import java.time.LocalDateTime;import java.time.YearMonth;import java.time.format.DateTimeFormatter;import static uk.ac.ed.inf.ilp.constant.SystemConstants.MAX_PIZZAS_PER_ORDER;//Things to Validate:// 1. Number of pizzas in the order// 2. Credit card info - Expiry Date// 3. Restaurant - Opening Days with the order date// 4. Total Price in Pence: Note - 100pence added for delivery for all orders// 5. Past Orders are not to be considered// 6. You have to check card number, expiration, order date and items among other details (as described in this document)// 7. All items in an order must come from the same pizza restaurant and are valid pizzas// 8. Total Price validation. (Price +100pence for delivery), Total > 0// 9. Validate past and future oprder datepublic class MainOrderValidation implements OrderValidation{    @Override    public Order validateOrder(Order orderToValidate, Restaurant[] definedRestaurants) {        // Variables for the orderToValidate        Pizza[] pizzasInOrder = orderToValidate.getPizzasInOrder();        LocalDate orderDate = orderToValidate.getOrderDate();        int totalPrice = orderToValidate.getPriceTotalInPence();        // Variables for credit card validation        String creditCardNumber = orderToValidate.getCreditCardInformation().getCreditCardNumber();        String creditCardExpiryDate = orderToValidate.getCreditCardInformation().getCreditCardExpiry();        String creditCvv = orderToValidate.getCreditCardInformation().getCvv();//      Number of pizzas in the order check        boolean pizzaCountCheck = pizzasInOrder.length <= MAX_PIZZAS_PER_ORDER;//      Credit Card Validation        boolean checkCardNumber = cardNumberCheck(creditCardNumber);        boolean checkCardExpiry = cardExpiryCheck(creditCardExpiryDate);        boolean checkCardCvv = cardCvvCheck(creditCvv);//      Total Price in Pence Validation        boolean totalPriceValidation = totalPriceCheck(pizzasInOrder, totalPrice);//      PIZZA_NOT_DEFINED in the order check        // Add other validations here, like validating the credit card info, checking the restaurant, etc.        // If all validations pass, set the order as valid        orderToValidate.setOrderStatus(OrderStatus.VALID_BUT_NOT_DELIVERED);        orderToValidate.setOrderValidationCode(OrderValidationCode.NO_ERROR);        return orderToValidate;    }    boolean totalPriceCheck(Pizza[] pizzasInOrder, int totalPrice){        int priceTotal = 0;        for (Pizza pizza : pizzasInOrder) {            priceTotal += pizza.priceInPence();        }        return ((priceTotal > 0) && (priceTotal+100 == totalPrice));    }//  Card Number Check: Length and Luhn Algorithm check    boolean cardNumberCheck(String cardNumber){        if (cardNumber == null || cardNumber.length() != 16) {            return false;        }        if (!cardNumber.matches("\\d+")) { // checks if the card number contains only digits            return false;        }        return true;    }//    Card CVV check    boolean cardCvvCheck(String cardCvv){        if (cardCvv == null || cardCvv.length() != 3) {            return false;        }        if (!cardCvv.matches("\\d+")) { // checks if the card number contains only digits            return false;        }        return true;    }//    Card Expiry Check    boolean cardExpiryCheck(String cardExpiryDate){        // Check if expiryDate is not null        if (cardExpiryDate == null) {            return false;        }        // Parse the expiry date        DateTimeFormatter formatter = DateTimeFormatter.ofPattern("MM/yy");        YearMonth expDate;        try {            expDate = YearMonth.parse(cardExpiryDate, formatter);        } catch (Exception e) {            return false;        }        // Compare the expiry year and month with the current year and month        return !YearMonth.now().isAfter(expDate);    }}